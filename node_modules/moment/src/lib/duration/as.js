import { daysToMonths, monthsToDays } from './bubble';
import { normalizeUnits } from '../units/aliases';
import toInt from '../utils/to-int';
export function as(units) {
    if (!this.isValid()) {
        return NaN;
    }

    var days;
    var months;
    var milliseconds = this._milliseconds;
    units = normalizeUnits(units);

    if (units === 'month' || units === 'quarter' || units === 'year') {
        days = this._days + milliseconds / 86400000;
        months = this._months + daysToMonths(days);

        switch (units) {
            case 'month':
                return months;

            case 'quarter':
                return months / 3;

            case 'year':
                return months / 12;
        }
    } else {
        // handle milliseconds separately because of floating point math errors (issue #1867)
        days = this._days + Math.round(monthsToDays(this._months));

        switch (units) {
            case 'week':
                return days / 7 + milliseconds / 604800000;

            case 'day':
                return days + milliseconds / 86400000;

            case 'hour':
                return days * 24 + milliseconds / 3600000;

            case 'minute':
                return days * 1440 + milliseconds / 60000;

            case 'second':
                return days * 86400 + milliseconds / 1000;
            // Math.floor prevents floating point math errors here

            case 'millisecond':
                return Math.floor(days * 86400000) + milliseconds;

            default:
                throw new Error('Unknown unit ' + units);
        }
    }
} // TODO: Use this.as('ms')?

export function valueOf() {
    if (!this.isValid()) {
        return NaN;
    }

    return this._milliseconds + this._days * 86400000 + (this._months % 12) * 2592000000 + toInt(this._months / 12) * 31536000000;
}

function makeAs(alias) {
    return function () {
        return this.as(alias);
    };
}

var asMilliseconds = makeAs('ms');
var asSeconds = makeAs('s');
var asMinutes = makeAs('m');
var asHours = makeAs('h');
var asDays = makeAs('d');
var asWeeks = makeAs('w');
var asMonths = makeAs('M');
var asQuarters = makeAs('Q');
var asYears = makeAs('y');
export { asMilliseconds, asSeconds, asMinutes, asHours, asDays, asWeeks, asMonths, asQuarters, asYears };
