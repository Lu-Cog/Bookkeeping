(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tally/index"],{"79aa":function(t,n,a){"use strict";a.r(n);var o=a("9cb2"),e=a.n(o);for(var i in o)"default"!==i&&function(t){a.d(n,t,(function(){return o[t]}))}(i);n["default"]=e.a},"992d":function(t,n,a){},"9cb2":function(t,n,a){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=a("0cab"),e=i(a("5c91"));function i(t){return t&&t.__esModule?t:{default:t}}function u(t,n,a){return n in t?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a,t}var s=function(){a.e("common/vendor").then(function(){return resolve(a("f5a6"))}.bind(null,a)).catch(a.oe)},c=function(){a.e("common/vendor").then(function(){return resolve(a("9bad"))}.bind(null,a)).catch(a.oe)},l=function(){a.e("common/vendor").then(function(){return resolve(a("3573"))}.bind(null,a)).catch(a.oe)},d=function(){a.e("components/tabbar/index").then(function(){return resolve(a("0bdd"))}.bind(null,a)).catch(a.oe)},r=getApp(),f={components:{vanButton:s,vanIcon:c,vanEmpty:l,tabbar:d},data:function(){return{options:[{text:"撤销",style:{backgroundColor:"#dd524d"}}],menuRect:r.globalData.menuRect,url:r.globalData.api_base_url,hi:(0,o.getTimeState)(),yud:"".concat((new Date).getMonth()+1,"月").concat((new Date).getDate(),"号"),books:[],bmw:750,book_id:0,tallyTotal:{expend:"",income:"",disregard:""},list1:[],list2:[],statis:{jins:"",jinz:"",zuos:"",zuoz:"",zuoc:""},hint:"",weather:"",selected:0,null:""}},onLoad:function(t){},onReady:function(){},onShow:function(){this.setData({book_id:r.globalData.book_id}),this.initFun()},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){this.initFun(),setTimeout((function(){t.stopPullDownRefresh()}),1e3)},onReachBottom:function(){},onShareAppMessage:function(){},methods:{initFun:function(){this.getWeather(),this.wish(),this.booksFun(),this.getTallyTotal(),this.getList()},bindClick:function(n,a){var o=this;t.showModal({content:"是否撤销？",success:function(n){n.confirm&&r.globalData.ajaxPost("/api/set-tally-cancel",{id:a},(function(n){200===n.code&&(t.showToast({title:"撤销成功"}),o.getList(),o.getTallyTotal())}))}})},getWeather:function(){var t=this;r.globalData.ajaxPost("/api/get-weather",{},(function(n){200===n.code&&t.setData({weather:n.data})}))},setJiZhang:function(){t.navigateTo({url:"/pages/add/index"})},wish:function(){var t=this;r.globalData.ajaxPost("/api/benediction",{},(function(n){200===n.code&&t.setData({hint:n.data.phrase})}))},setTab:function(t,n){var a=n.currentTarget.dataset.id;this.setData({book_id:a}),r.globalData.book_id=n.currentTarget.dataset.id,r.globalData.book_name=t,this.getTallyTotal(),this.getList()},booksFun:function(){var t=this;r.globalData.ajaxPost("/api/get-user-book",{},(function(n){if(200===n.code){var a=193*n.data.length+228+193;t.setData({bmw:a,books:n.data})}}))},getList:function(){var t=this,n=(0,e.default)().format("YYYY-MM-DD"),a=(0,e.default)().add(-1,"days").format("YYYY-MM-DD"),i={jins:0,jinz:0,jinc:0,zuos:0,zuoz:0,zuoc:0};r.globalData.ajaxPost("/api/get-tally-main-list",{start_time:n,end_time:n,book_id:this.book_id||"",page:1},(function(n){var a;200===n.code&&(n.data.list.forEach((function(t){1==t.type&&(i.jinz=i.jinz+Number(t.money)),2==t.type&&(i.jins=i.jins+Number(t.money)),3==t.type&&(i.jinc=i.jinc+Number(t.money)),t.staff_account_info&&(i.jinz+=Number(t.staff_account_info.money),t.staff_account_info.money=(0,o.toThousands)(t.staff_account_info.money)),t.money=(0,o.toThousands)(t.money),t.str_time=t.create_time})),t.setData((a={list1:n.data.list},u(a,"statis.jins",(0,o.toThousands)(i.jins)),u(a,"statis.jinz",(0,o.toThousands)(i.jinz)),u(a,"statis.jinc",(0,o.toThousands)(i.jinc)),a)))})),r.globalData.ajaxPost("/api/get-tally-main-list",{start_time:a,end_time:a,book_id:this.book_id||"",page:1},(function(n){var a;200===n.code&&(n.data.list.forEach((function(t){1==t.type&&(i.zuoz=i.zuoz+Number(t.money)),2==t.type&&(i.zuos=i.zuos+Number(t.money)),3==t.type&&(i.zuoc=i.zuoc+Number(t.money)),t.staff_account_info&&(i.zuoz+=Number(t.staff_account_info.money),t.staff_account_info.money=(0,o.toThousands)(t.staff_account_info.money)),t.money=(0,o.toThousands)(t.money),t.str_time=t.create_time})),t.setData((a={list2:n.data.list},u(a,"statis.zuos",(0,o.toThousands)(i.zuos)),u(a,"statis.zuoz",(0,o.toThousands)(i.zuoz)),u(a,"statis.zuoc",(0,o.toThousands)(i.zuoc)),a)))}))},getTallyTotal:function(){var t=this,n=(0,e.default)().startOf("month").format("YYYY-MM-DD"),a=(0,e.default)().endOf("month").format("YYYY-MM-DD");r.globalData.ajaxPost("/api/get-tally-main-total",{start_time:n,end_time:a,book_id:this.book_id||""},(function(n){200===n.code&&(n.data.disregard=(0,o.toThousands)(n.data.disregard),n.data.expend=(0,o.toThousands)(n.data.expend),n.data.income=(0,o.toThousands)(n.data.income),t.setData({tallyTotal:n.data}))}))},setUrlAddBooks:function(){t.navigateTo({url:"/pages/views/add_books"})}}};n.default=f}).call(this,a("543d")["default"])},a510:function(t,n,a){"use strict";var o=a("992d"),e=a.n(o);e.a},bd0a:function(t,n,a){"use strict";(function(t){a("2aad");o(a("66fd"));var n=o(a("e999"));function o(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=a,t(n.default)}).call(this,a("543d")["createPage"])},e999:function(t,n,a){"use strict";a.r(n);var o=a("eaa8"),e=a("79aa");for(var i in e)"default"!==i&&function(t){a.d(n,t,(function(){return e[t]}))}(i);a("a510");var u,s=a("f0c5"),c=Object(s["a"])(e["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],u);n["default"]=c.exports},eaa8:function(t,n,a){"use strict";a.d(n,"b",(function(){return e})),a.d(n,"c",(function(){return i})),a.d(n,"a",(function(){return o}));var o={uniSwipeAction:function(){return a.e("uni_modules/uni-swipe-action/components/uni-swipe-action/uni-swipe-action").then(a.bind(null,"e6e4"))},uniSwipeActionItem:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uni-swipe-action/components/uni-swipe-action-item/uni-swipe-action-item")]).then(a.bind(null,"0616"))}},e=function(){var t=this,n=t.$createElement;t._self._c},i=[]}},[["bd0a","common/runtime","common/vendor"]]]);