(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/index"],{"3f06":function(t,a,e){"use strict";(function(t){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=e("0cab");function n(t,a,e){return a in t?Object.defineProperty(t,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[a]=e,t}var i=function(){e.e("common/vendor").then(function(){return resolve(e("9bad"))}.bind(null,e)).catch(e.oe)},r=function(){e.e("common/vendor").then(function(){return resolve(e("3573"))}.bind(null,e)).catch(e.oe)},l=function(){e.e("components/tabbar/index").then(function(){return resolve(e("0bdd"))}.bind(null,e)).catch(e.oe)},s=getApp(),u={components:{vanIcon:i,vanEmpty:r,tabbar:l},data:function(){return{menuRect:s.globalData.menuRect,url:s.globalData.api_base_url,info:{avatar_url:"",sex:"",job:""},tallyTotal:{income:"",expend:"",disregard:""},books:[],bookInfo:{},formTj:{book_id:"",date:"",date_lebal:"",date_year_lebal:""},tongji:{income:"",expend:"",disregard:""},touchNum:0,selected:0,spec:0}},onLoad:function(t){var a;this.setData((a={},n(a,"formTj.date",(0,o.formatTimeTwo)((0,o.formatTime)(new Date),"Y-M")),n(a,"formTj.date_year_lebal",(0,o.formatTimeTwo)((0,o.formatTime)(new Date),"Y")),n(a,"formTj.date_lebal",(0,o.formatTimeTwo)((0,o.formatTime)(new Date),"M月份")),a))},onReady:function(){},onShow:function(){var t;this.setData((t={},n(t,"formTj.book_id",s.globalData.book_id),n(t,"bookInfo.name",s.globalData.book_name),t)),this.getInfo(),this.getTallyTotal(),this.getTallyTotalTime(),"function"===typeof this.getTabBar&&this.getTabBar()&&this.getTabBar().setData({selected:2})},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){var a;this.setData((a={},n(a,"formTj.date",(0,o.formatTimeTwo)((0,o.formatTime)(new Date),"Y-M")),n(a,"formTj.date_year_lebal",(0,o.formatTimeTwo)((0,o.formatTime)(new Date),"Y")),n(a,"formTj.date_lebal",(0,o.formatTimeTwo)((0,o.formatTime)(new Date),"M月份")),a)),this.getInfo(),this.getTallyTotal(),this.getTallyTotalTime(),setTimeout((function(){t.stopPullDownRefresh()}),1e3)},onReachBottom:function(){},onShareAppMessage:function(){},methods:{maskTouchend:function(t){var a=this,e=this;this.touchNum++,setTimeout((function(){3==a.touchNum&&s.globalData.ajaxPost("/api/set-user-spec",{},(function(t){200===t.code&&(e.spec=t.data.spec,e.getTallyTotal(),e.getTallyTotalTime())})),a.touchNum=0}),600)},getUserInfo:function(){var a=this;t.getUserProfile({desc:"获取头像昵称",success:function(e){var o;a.setData((o={},n(o,"info.avatar_url",e.userInfo.avatarUrl),n(o,"info.nick_name",e.userInfo.nickName),o)),s.globalData.ajaxPost("/api/set-user-info",a.info,(function(a){200===a.code&&t.showToast({title:"更新成功"})}))}})},booksFun:function(){var t=this;s.globalData.ajaxPost("/api/get-user-book",{},(function(a){200===a.code&&t.setData({books:a.data})}))},bindPickerChange:function(t){var a=this.books,e=t.detail.value;this.setData(n({bookInfo:a[e]},"formTj.book_id",a[e]["id"])),this.getTallyTotalTime()},bindPickerChangeDate:function(t){var a;this.setData((a={},n(a,"formTj.date_lebal",(0,o.formatTimeTwo)(t.detail.value,"M月份")),n(a,"formTj.date_year_lebal",(0,o.formatTimeTwo)(t.detail.value,"Y")),n(a,"formTj.date",t.detail.value),a)),this.getTallyTotalTime()},getTallyTotal:function(){var t=this;s.globalData.ajaxPost("/api/get-tally-main-total",{book_id:this.formTj.book_id},(function(a){200===a.code&&(a.data.disregard=(0,o.toThousands)(a.data.disregard),a.data.expend=(0,o.toThousands)(a.data.expend),a.data.income=(0,o.toThousands)(a.data.income),console.log(a.data,89),t.setData({tallyTotal:a.data}))}))},getTallyTotalTime:function(){var t=this,a=this.formTj;console.log(a,990);var e={};a.date&&(e.book_id=a.book_id,e.date=a.date,s.globalData.ajaxPost("/api/get-tally-main-total",a,(function(a){200===a.code&&t.setData({tongji:{disregard:(0,o.toThousands)(a.data.disregard),expend:(0,o.toThousands)(a.data.expend),income:(0,o.toThousands)(a.data.income)}})})))},getInfo:function(){var t=this;s.globalData.ajaxPost("/api/get-user-info",{},(function(a){200===a.code&&t.setData({info:a.data,spec:a.data.spec})}))},setUrlAddBooks:function(){t.navigateTo({url:"/pages/views/add_books"})}}};a.default=u}).call(this,e("543d")["default"])},6167:function(t,a,e){"use strict";e.r(a);var o=e("6d92"),n=e("772a");for(var i in n)"default"!==i&&function(t){e.d(a,t,(function(){return n[t]}))}(i);e("eefb");var r,l=e("f0c5"),s=Object(l["a"])(n["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],r);a["default"]=s.exports},"6d92":function(t,a,e){"use strict";var o;e.d(a,"b",(function(){return n})),e.d(a,"c",(function(){return i})),e.d(a,"a",(function(){return o}));var n=function(){var t=this,a=t.$createElement;t._self._c},i=[]},"772a":function(t,a,e){"use strict";e.r(a);var o=e("3f06"),n=e.n(o);for(var i in o)"default"!==i&&function(t){e.d(a,t,(function(){return o[t]}))}(i);a["default"]=n.a},b946:function(t,a,e){"use strict";(function(t){e("2aad");o(e("66fd"));var a=o(e("6167"));function o(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=e,t(a.default)}).call(this,e("543d")["createPage"])},c3d8:function(t,a,e){},eefb:function(t,a,e){"use strict";var o=e("c3d8"),n=e.n(o);n.a}},[["b946","common/runtime","common/vendor"]]]);